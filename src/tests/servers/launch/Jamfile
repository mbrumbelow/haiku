SubDir HAIKU_TOP src tests servers launch ;

AddSubDirSupportedPlatforms libbe_test ;

UsePrivateHeaders app kernel libroot shared storage support ;
UsePrivateSystemHeaders ;

UseHeaders [ FDirName $(HAIKU_TOP) src bin multiuser ] ;

SEARCH_SOURCE += [ FDirName $(HAIKU_TOP) src servers launch ] ;
SEARCH_SOURCE += [ FDirName $(HAIKU_TOP) src kits app ] ;
SEARCH_SOURCE += [ FDirName $(HAIKU_TOP) src bin ] ;

local defines = [ FDefines TEST_HAIKU=1 ] ;

SubDirCcFlags $(defines) ;
SubDirC++Flags $(defines) ;

StaticLibrary liblaunch_daemontest_shared.a :
	Conditions.cpp
	NetworkWatcher.cpp
	SettingsParser.cpp
	Utility.cpp
	;

UnitTestLib liblaunch_daemontest.so :
	LaunchDaemonTestAddon.cpp
	SettingsParserTest.cpp
	ConditionsTest.cpp
	UtilityTest.cpp

	: be network bnetapi liblaunch_daemontest_shared.a shared [ TargetLibstdc++ ]
		[ TargetLibsupc++ ]
;

Server test_launch_daemon :
	LaunchDaemon.cpp

	BaseJob.cpp
	Events.cpp
	Job.cpp
	Log.cpp
	Target.cpp
	VolumeWatcher.cpp
	Worker.cpp
	:
	be network bnetapi liblaunch_daemontest_shared.a libmultiuser_utils.a shared
		[ TargetLibstdc++ ]
	:
	LaunchDaemon.rdef
;

BinCommand test_launch_roster :
	LaunchRoster.cpp
	launch_roster.cpp
	:
	be
;
