{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "6cbfc3d2_27953e52",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2024-12-04T01:28:04Z",
      "side": 1,
      "message": "Hmm, I just realized that this will actually write back pages \"unfairly\", since we requeue the page at the end, if we don\u0027t actually schedule it to be written then it may not get written for some time. A different solution may be needed here...",
      "revId": "1630cbdb0b52db97356fe6a1a2267a12c456a72b",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b249fe35_1aad024c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2024-12-04T01:40:12Z",
      "side": 1,
      "message": "I guess we should store the first device ID we come across besides the one we\u0027re currently iterating over, and then prioritize that one on the next run?\n\nAlternatively: we could requeue this page at the front, and quit iterating over the queue immediately upon encountering such a page.",
      "parentUuid": "6cbfc3d2_27953e52",
      "revId": "1630cbdb0b52db97356fe6a1a2267a12c456a72b",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f36be33e_0d4aabb9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000001
      },
      "writtenOn": "2024-12-22T10:59:15Z",
      "side": 1,
      "message": "Rather than modifying the loop here, I would look into changing the modified page queue.\n\nMaybe weighted fair queuing can be used: one queue per device, and the algorithm can decide when to switch from one queue to another (for example, start by processing the queue with the largest page count).\n\nhttps://en.wikipedia.org/wiki/Fair_queuing\n\nBut of course it is more data structures to manage, so it may not be worth it.",
      "parentUuid": "b249fe35_1aad024c",
      "revId": "1630cbdb0b52db97356fe6a1a2267a12c456a72b",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4669e494_1ace1db8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2024-12-22T19:33:36Z",
      "side": 1,
      "message": "It will complicate the code because what queue a page is in is right now purely determined by its \"state\" field (with an extra field for debug assertions that\u0027s disabled on release builds). But I think in the end this will be necessary because we also have some open tickets about cached-but-modified pages filling up very fast on media that writes slowly, and we need to do something about that. Tracking to-be-written pages per-device sounds like the only really reasonable way to do that.",
      "parentUuid": "f36be33e_0d4aabb9",
      "revId": "1630cbdb0b52db97356fe6a1a2267a12c456a72b",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    }
  ]
}