{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "3f5333a1_544e258b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2022-06-01T16:50:20Z",
      "side": 1,
      "message": "korli should definitely review this.",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ec311cd9_d837bb90",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000391
      },
      "writtenOn": "2022-06-01T17:04:09Z",
      "side": 1,
      "message": "It seems this build is failing on gcc2 as gcc2 does not support __thread.\n\nShould I replace the glibc __thread variables with functions that calls pthread_* to get the thread-local values then? If I do that I\u0027d diverge from what the real glibc actually does.",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b0e03135_8156e404",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2022-06-01T17:27:56Z",
      "side": 1,
      "message": "It would be best to use Haiku-native TLS functions instead.\n\nWe aren\u0027t glibc, and we have been diverging further from glibc, so that\u0027s fine. What does musl do here?",
      "parentUuid": "ec311cd9_d837bb90",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0cfb1cbc_a78aa968",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-06-01T21:43:34Z",
      "side": 1,
      "message": "Also, can you mention this commit will fix https://dev.haiku-os.org/ticket/17168, and perhaps also https://dev.haiku-os.org/ticket/14356?",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8bc1fcf3_e18079a8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-06-02T00:47:16Z",
      "side": 1,
      "message": "See https://github.com/haiku/haiku/blob/master/headers/os/support/TLS.h for Haiku native TLS access.",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b5197a82_d46e7b3d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000391
      },
      "writtenOn": "2022-06-02T01:02:37Z",
      "side": 1,
      "message": "musl has its locale object integrated into the thread info, so they just need to call an internal __pthread_self() function.\n\nhttps://github.com/bminor/musl/blob/dcb31f6b450fdeed4dc364e15cd190e8562ea227/src/internal/locale_impl.h#L40",
      "parentUuid": "b0e03135_8156e404",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eb1d7cd2_88ac68a4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2022-06-02T01:07:21Z",
      "side": 1,
      "message": "Unfortunately as not all our threads are pthreads I don\u0027t think we can do that.",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1a99f25a_8bc91d12",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000391
      },
      "writtenOn": "2022-06-02T01:07:33Z",
      "side": 1,
      "message": "I can\u0027t find a comprehensive list of functions added by POSIX. Are there any, as I\u0027m afraid I might have left out some \"_l\" functions (For example, a quick search shows that \"nl_langinfo_l\" hasn\u0027t been included in this patch).",
      "parentUuid": "0cfb1cbc_a78aa968",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "825af81c_f32a15ad",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-06-02T03:55:18Z",
      "side": 1,
      "message": "You could probably approach this the same way that errno does, as it has a dedicated TLS slot.\n\nhttps://github.com/haiku/haiku/blob/master/src/system/libroot/posix/errno.c\nhttps://github.com/haiku/haiku/blob/master/headers/private/system/tls.h",
      "parentUuid": "eb1d7cd2_88ac68a4",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a36ff6a7_662c3c1c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-06-02T03:55:18Z",
      "side": 1,
      "message": "They\u0027re defined in ctype.h: https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/ctype.h.html",
      "parentUuid": "1a99f25a_8bc91d12",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4c70cf0d_81f436c7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000391
      },
      "writtenOn": "2022-06-02T03:57:48Z",
      "side": 1,
      "message": "Like I said, that\u0027s not a comprehensive list.\nSome such as nl_langinfo_l is not defined in ctype.h.",
      "parentUuid": "a36ff6a7_662c3c1c",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "22e13351_684380b9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000391
      },
      "writtenOn": "2022-06-02T03:57:48Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "825af81c_f32a15ad",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b92d2d77_a4468498",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000002
      },
      "writtenOn": "2022-06-02T04:06:13Z",
      "side": 1,
      "message": "Ah, I hadn\u0027t heard of langinfo before; in that case, see https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/langinfo.h.html",
      "parentUuid": "4c70cf0d_81f436c7",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "07501103_83d64a30",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000391
      },
      "writtenOn": "2022-06-02T04:45:18Z",
      "side": 1,
      "message": "Does Haiku\u0027s TLS have some destruction mechanism?\nerrno is an integer value, it can be trivially destroyed.\n\nHowever, what I\u0027m dealing here is a struct that is allocated separately for each thread, and needs to be destroyed on thread exit.",
      "parentUuid": "22e13351_684380b9",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b495dfce_17499cac",
        "filename": "headers/posix/ctype.h",
        "patchSetId": 3
      },
      "lineNbr": 71,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2022-06-01T16:50:20Z",
      "side": 1,
      "message": "Is this really needed? Can\u0027t we just change the contents of __ctype_b et al. instead?",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c93d6b42_955bfe3d",
        "filename": "headers/posix/ctype.h",
        "patchSetId": 3
      },
      "lineNbr": 71,
      "author": {
        "id": 1000391
      },
      "writtenOn": "2022-06-01T17:04:09Z",
      "side": 1,
      "message": "We can\u0027t make __ctype_b and others thread_local, or change their types.\nIt will:\n- Break the ABI (for C programs that rely on the macro instead of the real is_* functions).\n- Break the kernel, bootloader, and other stuff that does not support thread-local variables.",
      "parentUuid": "b495dfce_17499cac",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0020b4dd_c2cfef4a",
        "filename": "headers/posix/locale.h",
        "patchSetId": 3
      },
      "lineNbr": 66,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2022-06-01T16:50:20Z",
      "side": 1,
      "message": "Probably it would be better to make this fully opaque? Not sure.",
      "revId": "0f5e2d9cc320c18ac564dc4ca7db5a97b7da3b74",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    }
  ]
}