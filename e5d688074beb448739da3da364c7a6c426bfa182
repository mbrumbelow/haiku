{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "57ed885b_edba7292",
        "filename": "src/servers/input/InputServer.cpp",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2024-09-22T19:03:23Z",
      "side": 1,
      "message": "IMHO we shouldn\u0027t use a timeout of 0 here. Instead:\n\n1. We should have a small but nonzero timeout (perhaps 0.5 seconds), because multiple threads may request this at once, and we don\u0027t want apps to randomly get the default value just because two threads raced to get the settings.\n\n2. We should call debugger() if the timeout actually happens. This way, we will get an input_server \"crash\", and then we can recover from it more easily.",
      "revId": "e5d688074beb448739da3da364c7a6c426bfa182",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f3417bf0_4bff6df5",
        "filename": "src/servers/input/InputServer.cpp",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 1000223
      },
      "writtenOn": "2024-09-22T23:53:26Z",
      "side": 1,
      "message": "Not sure calling debugger from input_server is a good idea. The three times I triggered it I had to resort to Alt-SysRq-D and reboot from there.\n\nNot against the timeout. I\u0027ve tested those 0.5 seconds and it makes the system sluggish and lose some clicks, but doesn\u0027t feel completely frozen and you are compelled and able to restart it.\n\nI never triggered the contended path during normal operation, though. The requests for settings go through input_server message queue so there can\u0027t be two threads accessing them at the same time, I think. Collisions may happen between that, the add-ons manager and devices. I guess one could see it with an app registering or monitoring devices in a loop.",
      "parentUuid": "57ed885b_edba7292",
      "revId": "e5d688074beb448739da3da364c7a6c426bfa182",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c2a2f9b0_eeb451af",
        "filename": "src/servers/input/InputServer.cpp",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2024-09-22T23:54:33Z",
      "side": 1,
      "message": "\u003e The three times I triggered it I had to resort to Alt-SysRq-D and reboot from there.\n\nThis sounds like a bug; we should get debug_server+consoled or an automatic trip to KDL rather than needing to trigger it manually in this case.",
      "parentUuid": "f3417bf0_4bff6df5",
      "revId": "e5d688074beb448739da3da364c7a6c426bfa182",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "071ae7a4_8cdc26d2",
        "filename": "src/servers/input/InputServer.cpp",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 1000223
      },
      "writtenOn": "2024-09-23T09:45:17Z",
      "side": 1,
      "message": "We do get debugger+consoled, but at least for me it doesn\u0027t work. It seems it gets stuck somewhere before accepting user input. You can type (in one occasion I just got cursor movement from that, no letters on screen), but Enter does nothing, not even change line. And Del removes a character even with ctrl-alt-del.\n\nBut even if it worked, what do we expect an unsuspecting user to do in this case? I guess at most they would save a report and then quit. If they do resuming the thread they\u0027ll be back the moment they open a menu with the mouse. If they kill it, they\u0027ll have to reach for the power button.",
      "parentUuid": "c2a2f9b0_eeb451af",
      "revId": "e5d688074beb448739da3da364c7a6c426bfa182",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4f01cb47_6a04cf77",
        "filename": "src/servers/input/InputServer.cpp",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2024-09-23T14:42:06Z",
      "side": 1,
      "message": "launch_daemon should restart input_server when it\u0027s killed.\n\nI\u0027ve had it get stuck accepting user input too, or randomly reject the Enter key. That\u0027s a separate bug we should probably fix.",
      "parentUuid": "071ae7a4_8cdc26d2",
      "revId": "e5d688074beb448739da3da364c7a6c426bfa182",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a4060b53_63ff326f",
        "filename": "src/servers/input/InputServer.cpp",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 1000223
      },
      "writtenOn": "2024-09-24T12:45:29Z",
      "side": 1,
      "message": "\u003e launch_daemon should restart input_server when it\u0027s killed.\n\nIt probably does, but it seems input_server holds on to life (#10926). Even a SIGKILL does not seem to be enough.\n\nAnyway, that sounds like yet another issue. Maybe we can do with the notification/alert and add a note to 10926 or open a new one so that we change it to a debugger call when it works nicely if we really want that?",
      "parentUuid": "4f01cb47_6a04cf77",
      "revId": "e5d688074beb448739da3da364c7a6c426bfa182",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a0654d3a_9e000720",
        "filename": "src/servers/input/InputServer.cpp",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 1000011
      },
      "writtenOn": "2024-09-24T14:59:07Z",
      "side": 1,
      "message": "\u003e Even a SIGKILL does not seem to be enough.\n\nLikely it\u0027s blocked waiting for something in the kernel that doesn\u0027t set `B_CAN_INTERRUPT` but should.",
      "parentUuid": "a4060b53_63ff326f",
      "revId": "e5d688074beb448739da3da364c7a6c426bfa182",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5"
    }
  ]
}