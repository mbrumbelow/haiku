{
  "comments": [
    {
      "key": {
        "uuid": "770481c8_ab9f90ba",
        "filename": "src/add-ons/kernel/bus_managers/fdt/fdt_serial.cpp",
        "patchSetId": 5
      },
      "lineNbr": 44,
      "author": {
        "id": 1000172
      },
      "writtenOn": "2021-06-14T22:07:37Z",
      "side": 0,
      "message": "This code may be still useful and it can be moved to haiku_loader to place like here: https://git.haiku-os.org/haiku/tree/src/system/boot/platform/riscv/fdt.cpp?id\u003d1a5fe94b7a86d36fba08fb77665c3b298d44a9dd#n26. haiku_loader FDT handling may be shared between platforms.",
      "revId": "98587641d3f65aab640115053ba57b4591dc30a4",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "79eb3b61_c1e82077",
        "filename": "src/add-ons/kernel/bus_managers/fdt/fdt_serial.cpp",
        "patchSetId": 5
      },
      "lineNbr": 44,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-08-04T14:29:42Z",
      "side": 0,
      "message": "That\u0027s fine with me.\n\nTo be honest, with the FDT bus code we could start detecting the uart\u0027s better vs doing a bunch of one-off string comparisons.",
      "parentUuid": "770481c8_ab9f90ba",
      "revId": "98587641d3f65aab640115053ba57b4591dc30a4",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a395b2c8_1e5bcc63",
        "filename": "src/add-ons/kernel/bus_managers/fdt/fdt_serial.h",
        "patchSetId": 5
      },
      "lineNbr": 16,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-06-14T21:41:40Z",
      "side": 0,
      "message": "This call was used from multiple places *including* the native u-boot loader.  By merging this are we committing to no longer support the native u-boot loader?",
      "revId": "98587641d3f65aab640115053ba57b4591dc30a4",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "952f4f0a_3e7aaabc",
        "filename": "src/add-ons/kernel/bus_managers/fdt/fdt_serial.h",
        "patchSetId": 5
      },
      "lineNbr": 16,
      "author": {
        "id": 1000172
      },
      "writtenOn": "2021-06-14T21:48:49Z",
      "side": 0,
      "message": "UART register can be passed by kernel_args and identified by haiku_loader. I already did this for RISC-V PLIC and CLINT.",
      "parentUuid": "a395b2c8_1e5bcc63",
      "revId": "98587641d3f65aab640115053ba57b4591dc30a4",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "04f97ce6_336476a8",
        "filename": "src/add-ons/kernel/bus_managers/fdt/fdt_serial.h",
        "patchSetId": 5
      },
      "lineNbr": 16,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-08-04T14:29:42Z",
      "side": 0,
      "message": "Hm.  sure, but that isn\u0027t part of the specification for the u-boot standard.\n\nWe could pass the register via kernel_args, but we would also need to pass the uart speed as well as device used.  Do we know if this data is available within the u-boot cli as a variable? Otherwise the boot.scr\u0027s would need modified per-board.",
      "parentUuid": "952f4f0a_3e7aaabc",
      "revId": "98587641d3f65aab640115053ba57b4591dc30a4",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b703e774_5a2ae7aa",
        "filename": "src/add-ons/kernel/bus_managers/fdt/fdt_serial.h",
        "patchSetId": 5
      },
      "lineNbr": 16,
      "author": {
        "id": 1000001
      },
      "writtenOn": "2021-08-04T14:44:26Z",
      "side": 0,
      "message": "In Linux the UART to use would be received from the \"chosen/stdout-path\" node in the FDT. This would already be set in most FDTs for common hardware. It does not specify the baudrate, but we should be able to use a reasonable default value (say 115200 baud) which will work in pretty much all cases.\n\nhttps://www.kernel.org/doc/html/latest/devicetree/usage-model.html\n\nBut then in Linux this can also be changed from the kernel command line (bootargs). Which itself can be specified inside the fdt (\"chosen/bootargs\") or in some other way from a user specified command line.\n\nThe idea is that you can just run \"boot\" from uboot without any specific args, and something will happen because there are sane default values in the FDT. But you can customize from the bootargs without recompiling everything.\n\nIn our case, we already have all we need for customization in haiku_loader, so we don\u0027t really need u-boot bootargs. The FDT \"chosen\" could be useful if we want to run on a wide range of hardware, but since we need some output from haiku_loader (to show the menu, etc), it makes sense that this code to find info in the fdt is done in haiku_loader and the kernel gets the info it needs more directly, without having to parse the FDT by itself?",
      "parentUuid": "04f97ce6_336476a8",
      "revId": "98587641d3f65aab640115053ba57b4591dc30a4",
      "serverId": "40b9299a-d8a8-485d-9b01-e6d3f45eefb5",
      "unresolved": true
    }
  ]
}